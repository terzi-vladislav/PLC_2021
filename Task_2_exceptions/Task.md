# Реализация исключений

Оценка: 3 балла.

## Задача

Посмотрите: http://www.cplusplus.com/reference/csetjmp/

В стандарте C++ оставлена совместимость с C по части нелокальных прыжков (goto в другую функцию). Функции setjmp и longjmp позволяют реализовать любой нелинейный поток управления. Воспользуйтесь этими функциями для реализации собственных исключений.

Создайте систему макросов вроде TRY, CATCH, THROW, которая будет имитировать работу исключений в C++.

Требуется, чтобы по longjmp не только менялся контекст, но также очищался стек. То есть удалялись все объекты, созданные на стеке, в том числе аргументы функций.

Поддержите аварийное завершение программы по повторному исключению во время очистки стека.

## Требования

* Требуется, чтобы исключение могло “пролетать” сквозь несколько вложенных функций;
* Продемонстрируйте в программе, что при вызове THROW вызываются деструкторы локальных объектов на всех стекфреймах вплоть до того, где написаны TRY/CATCH;
* Дополнительно: реализовать типизацию исключений. Типизация может быть реализована через вывод исключений из общего базового класса или просто с помощью задания исключений константами (например, BAD_FILE=1, OUT_OF_MEMORY=2 и т.д.). При этом блок CATCH должен отлавливать только исключения подходящего типа.
* Нельзя использовать готовые системы макросов из каких-либо фреймворков.

## Разбалловка

1 балл - Реализация TRY/CATCH/THROW
1 балл - Вызов деструкторов при размотке стека
1 балл - Учёт типизации исключений

## Рекомендации
Рекомендуется “расширить язык” собственными макросами 

Отключите поддержку исключений при компиляции, чтобы убедиться, что Ваши объекты удаляются именно Вашим кодом. Кроме того, setjmp/longjmp плохо взаимодействуют с 'try/catch'.
В VisualStudio это делается через настройки проекта
C/C++ -> Code Generation -> Enable C++ Exception: No

В GCC есть аргумент командной строки
		'-f-no-exceptions'